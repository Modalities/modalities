

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modalities.utils package &mdash; Modalities 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="modalities.utils.profilers package" href="modalities.utils.profilers.html" />
    <link rel="prev" title="modalities.training.gradient_clipping package" href="modalities.training.gradient_clipping.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Modalities
              <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_cards.html">Model Cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../memmap.html">MemMap Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entrypoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints.html">Entrypoints</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VSCode Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vs_code_setup.html">VSCode Setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Future Work</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../future_work.html">Future Work</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">modalities</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modalities.html">modalities package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="modalities.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html">modalities.checkpointing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html">modalities.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.html">modalities.conversion package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html">modalities.dataloader package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.html">modalities.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html">modalities.logging_broker package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html">modalities.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html">modalities.nn package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html">modalities.optimizers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html">modalities.preprocessing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html">modalities.registry package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html">modalities.running_env package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html">modalities.tokenization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html">modalities.training package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">modalities.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.api">modalities.api module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.batch">modalities.batch module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.evaluator">modalities.evaluator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.exceptions">modalities.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.gym">modalities.gym module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.loss_functions">modalities.loss_functions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.main">modalities.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.trainer">modalities.trainer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities.util">modalities.util module</a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.html#module-modalities">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Modalities</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">modalities</a></li>
          <li class="breadcrumb-item"><a href="modalities.html">modalities package</a></li>
      <li class="breadcrumb-item active">modalities.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/modalities.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modalities-utils-package">
<h1>modalities.utils package<a class="headerlink" href="#modalities-utils-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="modalities.utils.profilers.html">modalities.utils.profilers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.profilers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers.batch_generator">modalities.utils.profilers.batch_generator module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.DatasetBatchGeneratorIF"><code class="docutils literal notranslate"><span class="pre">DatasetBatchGeneratorIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.DatasetBatchGeneratorIF.get_dataset_batch"><code class="docutils literal notranslate"><span class="pre">DatasetBatchGeneratorIF.get_dataset_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGenerator"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGenerator.get_dataset_batch"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGenerator.get_dataset_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGeneratorConfig"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGeneratorConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGeneratorConfig.batch_size"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGeneratorConfig.batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGeneratorConfig.model_config"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGeneratorConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGeneratorConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGeneratorConfig.sequence_length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities.utils.profilers.batch_generator.RandomDatasetBatchGeneratorConfig.vocab_size"><code class="docutils literal notranslate"><span class="pre">RandomDatasetBatchGeneratorConfig.vocab_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.utils.communication_test">
<span id="modalities-utils-communication-test-module"></span><h2>modalities.utils.communication_test module<a class="headerlink" href="#module-modalities.utils.communication_test" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.communication_test.run_communication_test">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.communication_test.</span></span><span class="sig-name descname"><span class="pre">run_communication_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/communication_test.html#run_communication_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.communication_test.run_communication_test" title="Link to this definition"></a></dt>
<dd><p>Test the all_gather communication operation in a distributed setting.</p>
</dd></dl>

</section>
<section id="module-modalities.utils.logger_utils">
<span id="modalities-utils-logger-utils-module"></span><h2>modalities.utils.logger_utils module<a class="headerlink" href="#module-modalities.utils.logger_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.logger_utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.logger_utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/logger_utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.logger_utils.get_logger" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities.utils.mfu">
<span id="modalities-utils-mfu-module"></span><h2>modalities.utils.mfu module<a class="headerlink" href="#module-modalities.utils.mfu" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.mfu.GPT2MFUCalculator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.mfu.</span></span><span class="sig-name descname"><span class="pre">GPT2MFUCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_embd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapped_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/mfu.html#GPT2MFUCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.mfu.GPT2MFUCalculator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.utils.mfu.MFUCalculatorABC" title="modalities.utils.mfu.MFUCalculatorABC"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFUCalculatorABC</span></code></a></p>
<p>Class to calculate the Model Flops Utilization (MFU) for a given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>n_embd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>world_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>wrapped_model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/fsdp.html#torch.distributed.fsdp.FullyShardedDataParallel" title="(in PyTorch v2.8)"><em>FullyShardedDataParallel</em></a><em> | </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/distributed.fsdp.fully_shard.html#torch.distributed.fsdp.FSDPModule" title="(in PyTorch v2.8)"><em>FSDPModule</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.mfu.GPT2MFUCalculator.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples_per_second</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/mfu.html#GPT2MFUCalculator.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.mfu.GPT2MFUCalculator.compute" title="Link to this definition"></a></dt>
<dd><p>Computes the MFU for the given number of samples per second.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>num_samples_per_second</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples_per_second (torch.Tensor): The number of samples per second.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: The computed MFU.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.mfu.MFUCalculatorABC">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.mfu.</span></span><span class="sig-name descname"><span class="pre">MFUCalculatorABC</span></span><a class="reference internal" href="../_modules/modalities/utils/mfu.html#MFUCalculatorABC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.mfu.MFUCalculatorABC" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interface for calculating the Model Flops Utilization (MFU).</p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.mfu.MFUCalculatorABC.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples_per_second</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/mfu.html#MFUCalculatorABC.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.mfu.MFUCalculatorABC.compute" title="Link to this definition"></a></dt>
<dd><p>Computes the MFU for the given number of samples per second.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>num_samples_per_second</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_samples_per_second (torch.Tensor): The number of samples per second.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: The computed MFU.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.utils.number_conversion">
<span id="modalities-utils-number-conversion-module"></span><h2>modalities.utils.number_conversion module<a class="headerlink" href="#module-modalities.utils.number_conversion" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">LocalNumBatchesFromNumSamplesConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#LocalNumBatchesFromNumSamplesConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>global_num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.global_num_samples">
<span class="sig-name descname"><span class="pre">global_num_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.global_num_samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">LocalNumBatchesFromNumTokensConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#LocalNumBatchesFromNumTokensConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>global_num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.global_num_tokens">
<span class="sig-name descname"><span class="pre">global_num_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.global_num_tokens" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.sequence_length">
<span class="sig-name descname"><span class="pre">sequence_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.sequence_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumSamplesFromNumTokensConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumSamplesFromNumTokensConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumSamplesFromNumTokensConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.num_tokens">
<span class="sig-name descname"><span class="pre">num_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.num_tokens" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.sequence_length">
<span class="sig-name descname"><span class="pre">sequence_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.sequence_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumStepsFromNumSamplesConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumStepsFromNumSamplesConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>global_num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.global_num_samples">
<span class="sig-name descname"><span class="pre">global_num_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.global_num_samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.gradient_accumulation_steps">
<span class="sig-name descname"><span class="pre">gradient_accumulation_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.gradient_accumulation_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumStepsFromNumTokensConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumStepsFromNumTokensConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>global_num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.global_num_tokens">
<span class="sig-name descname"><span class="pre">global_num_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.global_num_tokens" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.gradient_accumulation_steps">
<span class="sig-name descname"><span class="pre">gradient_accumulation_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.gradient_accumulation_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromNumTokensConfig.sequence_length">
<span class="sig-name descname"><span class="pre">sequence_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.sequence_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumStepsFromRawDatasetIndexConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumStepsFromRawDatasetIndexConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raw_index_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps">
<span class="sig-name descname"><span class="pre">gradient_accumulation_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.raw_index_path">
<span class="sig-name descname"><span class="pre">raw_index_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a></em><a class="headerlink" href="#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.raw_index_path" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumTokensFromNumStepsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumTokensFromNumStepsConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Ge</em><em>(</em><em>ge=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.gradient_accumulation_steps">
<span class="sig-name descname"><span class="pre">gradient_accumulation_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.gradient_accumulation_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_steps">
<span class="sig-name descname"><span class="pre">num_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromNumStepsConfig.sequence_length">
<span class="sig-name descname"><span class="pre">sequence_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.sequence_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumTokensFromPackedMemMapDatasetContinuousConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>FieldInfo</em><em>(</em><em>annotation=NoneType</em><em>, </em><em>required=True</em><em>, </em><em>metadata=</em><em>[</em><em>Strict</em><em>(</em><em>strict=True</em><em>)</em><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>sample_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>reuse_last_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path">
<span class="sig-name descname"><span class="pre">dataset_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps">
<span class="sig-name descname"><span class="pre">gradient_accumulation_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size">
<span class="sig-name descname"><span class="pre">local_micro_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.num_ranks">
<span class="sig-name descname"><span class="pre">num_ranks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.num_ranks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.reuse_last_target">
<span class="sig-name descname"><span class="pre">reuse_last_target</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.reuse_last_target" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sample_key">
<span class="sig-name descname"><span class="pre">sample_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sample_key" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length">
<span class="sig-name descname"><span class="pre">sequence_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotated</span></code><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumberConversion</span></span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_global_num_seen_tokens_from_checkpoint_path">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_global_num_seen_tokens_from_checkpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_global_num_seen_tokens_from_checkpoint_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_global_num_seen_tokens_from_checkpoint_path" title="Link to this definition"></a></dt>
<dd><p>Returns the global num seen tokens from the checkpoint path.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>checkpoint_path (Path): Path to the checkpoint file.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Num seen tokens from the checkpoint path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_global_num_target_tokens_from_checkpoint_path">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_global_num_target_tokens_from_checkpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_global_num_target_tokens_from_checkpoint_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_global_num_target_tokens_from_checkpoint_path" title="Link to this definition"></a></dt>
<dd><p>Returns the global num target tokens from the checkpoint path.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>checkpoint_path (Path): Path to the checkpoint file.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Num target tokens from the checkpoint path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_last_step_from_checkpoint_path">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_last_step_from_checkpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_last_step_from_checkpoint_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_last_step_from_checkpoint_path" title="Link to this definition"></a></dt>
<dd><p>Returns the last step from the checkpoint path.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>checkpoint_path (Path): Path to the checkpoint file.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Last step from the checkpoint path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_samples">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_local_num_batches_from_num_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_local_num_batches_from_num_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_samples" title="Link to this definition"></a></dt>
<dd><p>Calculates the number of local batches for each rank, given the global
number of samples and number of ranks.
This helper function is primarily used to calculate the number of batches to
skip when resuming a dataloader during warmstart.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_ranks (int): Global number of ranks.
global_num_samples (int): Global number of samples.
local_micro_batch_size (int): Local micro batch size on single rank.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of local batches for single rank.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_tokens">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_local_num_batches_from_num_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_local_num_batches_from_num_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_tokens" title="Link to this definition"></a></dt>
<dd><p>Calculates the number of local batches for each rank, given the global
number of tokens and number of ranks.
This helper function is primarily used to calculate a dataloader’s number of batches (total and to skip)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_ranks (int): Global number of ranks.
global_num_tokens (int): Global number of tokens.
sequence_length (int): Sequence length of the model.
local_micro_batch_size (int): Local micro batch size on single rank.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of local batches for single rank.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_samples_from_num_tokens">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_samples_from_num_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_samples_from_num_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_samples_from_num_tokens" title="Link to this definition"></a></dt>
<dd><p>Calculates the number of samples given the global number of tokens and sequence length.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_tokens (int): Global number of tokens.
sequence_length (int): Sequence length of the model.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_seen_steps_from_checkpoint_path">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_seen_steps_from_checkpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_seen_steps_from_checkpoint_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_seen_steps_from_checkpoint_path" title="Link to this definition"></a></dt>
<dd><p>Returns the number of seen steps from the checkpoint path.”</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>checkpoint_path (Path): Path to the checkpoint file.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of seen steps from the checkpoint path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_samples">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_steps_from_num_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_accumulation_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_steps_from_num_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_samples" title="Link to this definition"></a></dt>
<dd><p>Calculates the number of steps given the global
number of samples, local micro batch size, number of ranks and gradient accumulation steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_ranks (int): Global number of ranks.
local_micro_batch_size (int): Local micro batch size on single rank.
global_num_samples (int): Global number of samples.
gradient_accumulation_steps (int): Number of gradient accumulation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_tokens">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_steps_from_num_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_accumulation_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_steps_from_num_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_tokens" title="Link to this definition"></a></dt>
<dd><p>Calculates the number of steps given the global
number of tokens, local micro batch size number of ranks and gradient accumulation steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>num_ranks (int): Global number of ranks.
local_micro_batch_size (int): Local micro batch size on single rank.
global_num_tokens (int): Global number of tokens.
sequence_length (int): Sequence length of the model.
gradient_accumulation_steps (int): Number of gradient accumulation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_steps_from_raw_dataset_index">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_steps_from_raw_dataset_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_index_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_accumulation_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_steps_from_raw_dataset_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_raw_dataset_index" title="Link to this definition"></a></dt>
<dd><p>Get the number of steps from the raw index, number of ranks, local micro batch size
and gradient accumulation steps. The index is a list of tuples where each tuple contains
the offset and length of a sample in the raw data.
Note, the index is not packed and the number of samples in respective raw JSONL
file is the same as the length of the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>raw_index_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>raw_index_path (Path): Path to the raw index file of the JSONL dataset.
num_ranks (int): Global number of ranks.
local_micro_batch_size (int): Local micro batch size on single rank.
gradient_accumulation_steps (int): Number of gradient accumulation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_target_steps_from_checkpoint_path">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_target_steps_from_checkpoint_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_target_steps_from_checkpoint_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_target_steps_from_checkpoint_path" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_num_steps">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_tokens_from_num_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_accumulation_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_tokens_from_num_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_num_steps" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Calculates the number of global tokens given the number of steps, number of ranks, local micro batch size,</dt><dd><p>sequence length and gradient accumulation steps.</p>
</dd>
<dt>Args:</dt><dd><p>num_steps (int): Number of steps.
num_ranks (int): Global number of ranks.
local_micro_batch_size (int): Local micro batch size on single rank.
sequence_length (int): Sequence length of the model.
gradient_accumulation_steps (int): Number of gradient accumulation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of global tokens.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_num_tokens_from_packed_mem_map_dataset_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_accumulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_last_target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>sequence_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_accumulation_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>sample_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>reuse_last_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Get the number of tokens in a tokenized dataset that will be effectively used during training.</dt><dd><p>Due to the way the data is packed, batched and distributed, the number of tokens used during training
might not the same as the number of tokens in the dataset.</p>
<dl class="simple">
<dt>The number of tokens that are used during training is calculated as follows:</dt><dd><dl class="simple">
<dt>num_steps = num_dataset_tokens // sequence_length// num_ranks //</dt><dd><p>local_micro_batch_size // gradient_accumulation_steps</p>
</dd>
<dt>global_num_tokens = num_steps * sequence_length * num_ranks *</dt><dd><p>local_micro_batch_size * gradient_accumulation_steps</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Args:</dt><dd><p>dataset_path (Path): Path to the tokenized dataset.
sequence_length (int): Sequence length of the model.
num_ranks (int): Global number of ranks.
local_micro_batch_size (int): Local micro batch size on single rank.
gradient_accumulation_steps (int): Number of gradient accumulation steps.</p>
</dd>
<dt>Returns:</dt><dd><p>int: Number of tokens that will be effectively used during training.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.number_conversion.</span></span><span class="sig-name descname"><span class="pre">NumberConversionFromCheckpointPathConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/number_conversion.html#NumberConversionFromCheckpointPathConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code></p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises [<cite>ValidationError</cite>][pydantic_core.ValidationError] if the input data cannot be
validated to form a valid model.</p>
<p><cite>self</cite> is explicitly positional-only to allow <cite>self</cite> as a field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.checkpoint_path">
<span class="sig-name descname"><span class="pre">checkpoint_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a></em><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.checkpoint_path" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.model_config">
<span class="sig-name descname"><span class="pre">model_config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ClassVar[ConfigDict]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.model_config" title="Link to this definition"></a></dt>
<dd><p>Configuration for the model, should be a dictionary conforming to [<cite>ConfigDict</cite>][pydantic.config.ConfigDict].</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.utils.seeding">
<span id="modalities-utils-seeding-module"></span><h2>modalities.utils.seeding module<a class="headerlink" href="#module-modalities.utils.seeding" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.seeding.calculate_hashed_seed">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.seeding.</span></span><span class="sig-name descname"><span class="pre">calculate_hashed_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4294967295</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/seeding.html#calculate_hashed_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.seeding.calculate_hashed_seed" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>input_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>)</p></li>
<li><p><strong>max_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities.utils.typing_utils">
<span id="modalities-utils-typing-utils-module"></span><h2>modalities.utils.typing_utils module<a class="headerlink" href="#module-modalities.utils.typing_utils" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.utils.verify_tokenization_consistency">
<span id="modalities-utils-verify-tokenization-consistency-module"></span><h2>modalities.utils.verify_tokenization_consistency module<a class="headerlink" href="#module-modalities.utils.verify_tokenization_consistency" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.TokenizerTypes">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.utils.verify_tokenization_consistency.</span></span><span class="sig-name descname"><span class="pre">TokenizerTypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/verify_tokenization_consistency.html#TokenizerTypes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.TokenizerTypes" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.TokenizerTypes.hugging_face">
<span class="sig-name descname"><span class="pre">hugging_face</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hugging_face'</span></em><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.TokenizerTypes.hugging_face" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.TokenizerTypes.sentence_piece">
<span class="sig-name descname"><span class="pre">sentence_piece</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sentence_piece'</span></em><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.TokenizerTypes.sentence_piece" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.build_hf_tokenization_components">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.verify_tokenization_consistency.</span></span><span class="sig-name descname"><span class="pre">build_hf_tokenization_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path_or_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_token</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/verify_tokenization_consistency.html#build_hf_tokenization_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.build_hf_tokenization_components" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokenizer_path_or_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>eod_token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.build_sp_tokenization_components">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.verify_tokenization_consistency.</span></span><span class="sig-name descname"><span class="pre">build_sp_tokenization_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_token</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/verify_tokenization_consistency.html#build_sp_tokenization_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.build_sp_tokenization_components" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokenizer_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>eod_token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.utils.verify_tokenization_consistency.verify_tokenization_consistency">
<span class="sig-prename descclassname"><span class="pre">modalities.utils.verify_tokenization_consistency.</span></span><span class="sig-name descname"><span class="pre">verify_tokenization_consistency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eod_token_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jsonl_text_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/utils/verify_tokenization_consistency.html#verify_tokenization_consistency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.utils.verify_tokenization_consistency.verify_tokenization_consistency" title="Link to this definition"></a></dt>
<dd><p>Verifies that the indexation and tokenization is consistent.
This function applies the indexation and tokenization routines and then verifies
that the index always captures entire samples and that the tokens in the JSON
are correctly determined.
For an example verification check out the test_end_to_end_indexation_and_tokenization_consistency test</p>
<dl class="simple">
<dt>Args:</dt><dd><p>src_path (Path): Path to the JSONL file
eod_token (str): end of document token
eod_token_id (int): The token id of the end of document token
tokenizer (Callable[[str], list[int]]): Callable executing the tokenization
tokenizer_config (dict): Tokenizer config (same as used in the tokenization entry point)
jsonl_text_key (str): The key mapping to the text of interest in each JSON file</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>eod_token</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>eod_token_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>tokenizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>tokenizer_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>)</p></li>
<li><p><strong>jsonl_text_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-modalities.utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modalities.training.gradient_clipping.html" class="btn btn-neutral float-left" title="modalities.training.gradient_clipping package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modalities.utils.profilers.html" class="btn btn-neutral float-right" title="modalities.utils.profilers package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
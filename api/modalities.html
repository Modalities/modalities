

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modalities package &mdash; Modalities 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="modalities.checkpointing package" href="modalities.checkpointing.html" />
    <link rel="prev" title="modalities" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Modalities
              <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_cards.html">Model Cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../memmap.html">MemMap Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entrypoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints.html">Entrypoints</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VSCode Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vs_code_setup.html">VSCode Setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Future Work</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../future_work.html">Future Work</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">modalities</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">modalities package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html">modalities.checkpointing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html">modalities.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.html">modalities.conversion package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html">modalities.dataloader package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.html">modalities.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html">modalities.logging_broker package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html">modalities.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html">modalities.nn package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html">modalities.optimizers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html">modalities.preprocessing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html">modalities.registry package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html">modalities.running_env package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html">modalities.tokenization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html">modalities.training package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html">modalities.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modalities-api-module">modalities.api module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.batch">modalities.batch module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.Batch"><code class="docutils literal notranslate"><span class="pre">Batch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.DatasetBatch"><code class="docutils literal notranslate"><span class="pre">DatasetBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.EvaluationResultBatch"><code class="docutils literal notranslate"><span class="pre">EvaluationResultBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.InferenceResultBatch"><code class="docutils literal notranslate"><span class="pre">InferenceResultBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.ResultItem"><code class="docutils literal notranslate"><span class="pre">ResultItem</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.TorchDeviceMixin"><code class="docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modalities-evaluator-module">modalities.evaluator module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.exceptions">modalities.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.BatchStateError"><code class="docutils literal notranslate"><span class="pre">BatchStateError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.CheckpointingError"><code class="docutils literal notranslate"><span class="pre">CheckpointingError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.ConfigError"><code class="docutils literal notranslate"><span class="pre">ConfigError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.DatasetNotFoundError"><code class="docutils literal notranslate"><span class="pre">DatasetNotFoundError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.ModelStateError"><code class="docutils literal notranslate"><span class="pre">ModelStateError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.OptimizerError"><code class="docutils literal notranslate"><span class="pre">OptimizerError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.RunningEnvError"><code class="docutils literal notranslate"><span class="pre">RunningEnvError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.TimeRecorderStateError"><code class="docutils literal notranslate"><span class="pre">TimeRecorderStateError</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modalities-gym-module">modalities.gym module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.loss_functions">modalities.loss_functions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.CLMCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.Loss"><code class="docutils literal notranslate"><span class="pre">Loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.NCELoss"><code class="docutils literal notranslate"><span class="pre">NCELoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.nce_loss"><code class="docutils literal notranslate"><span class="pre">nce_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modalities-main-module">modalities.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modalities-trainer-module">modalities.trainer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.util">modalities.util module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.TimeRecorder"><code class="docutils literal notranslate"><span class="pre">TimeRecorder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.TimeRecorderStates"><code class="docutils literal notranslate"><span class="pre">TimeRecorderStates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.cpu_scalar_float"><code class="docutils literal notranslate"><span class="pre">cpu_scalar_float()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.cpu_scalar_int"><code class="docutils literal notranslate"><span class="pre">cpu_scalar_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.format_metrics_to_gb"><code class="docutils literal notranslate"><span class="pre">format_metrics_to_gb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_experiment_id_from_config"><code class="docutils literal notranslate"><span class="pre">get_experiment_id_from_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_local_number_of_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">get_local_number_of_trainable_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_module_class_from_name"><code class="docutils literal notranslate"><span class="pre">get_module_class_from_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_synced_experiment_id_of_run"><code class="docutils literal notranslate"><span class="pre">get_synced_experiment_id_of_run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_synced_string"><code class="docutils literal notranslate"><span class="pre">get_synced_string()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_total_number_of_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">get_total_number_of_trainable_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.parse_enum_by_name"><code class="docutils literal notranslate"><span class="pre">parse_enum_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.print_rank_0"><code class="docutils literal notranslate"><span class="pre">print_rank_0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.warn_rank_0"><code class="docutils literal notranslate"><span class="pre">warn_rank_0()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Modalities</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">modalities</a></li>
      <li class="breadcrumb-item active">modalities package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/modalities.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modalities-package">
<h1>modalities package<a class="headerlink" href="#modalities-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="modalities.checkpointing.html">modalities.checkpointing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.fsdp.html">modalities.checkpointing.fsdp package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp.fsdp_checkpoint_loading">modalities.checkpointing.fsdp.fsdp_checkpoint_loading module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp.fsdp_checkpoint_saving">modalities.checkpointing.fsdp.fsdp_checkpoint_saving module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.stateful.html">modalities.checkpointing.stateful package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.stateful.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.stateful.html#module-modalities.checkpointing.stateful.app_state">modalities.checkpointing.stateful.app_state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.stateful.html#module-modalities.checkpointing.stateful.app_state_factory">modalities.checkpointing.stateful.app_state_factory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.stateful.html#module-modalities.checkpointing.stateful">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.torch.html">modalities.checkpointing.torch package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#modalities-checkpointing-torch-torch-checkpoint-loading-module">modalities.checkpointing.torch.torch_checkpoint_loading module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#module-modalities.checkpointing.torch">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#modalities-checkpointing-checkpoint-conversion-module">modalities.checkpointing.checkpoint_conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_loading">modalities.checkpointing.checkpoint_loading module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.DistributedCheckpointLoadingIF"><code class="docutils literal notranslate"><span class="pre">DistributedCheckpointLoadingIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.DistributedCheckpointLoadingIF.load_checkpoint_"><code class="docutils literal notranslate"><span class="pre">DistributedCheckpointLoadingIF.load_checkpoint_()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.FSDP1CheckpointLoadingIF"><code class="docutils literal notranslate"><span class="pre">FSDP1CheckpointLoadingIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.FSDP1CheckpointLoadingIF.load_model_checkpoint"><code class="docutils literal notranslate"><span class="pre">FSDP1CheckpointLoadingIF.load_model_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.FSDP1CheckpointLoadingIF.load_optimizer_checkpoint_"><code class="docutils literal notranslate"><span class="pre">FSDP1CheckpointLoadingIF.load_optimizer_checkpoint_()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving">modalities.checkpointing.checkpoint_saving module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointSaving"><code class="docutils literal notranslate"><span class="pre">CheckpointSaving</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointSaving.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointSaving.save_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_execution">modalities.checkpointing.checkpoint_saving_execution module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_execution.CheckpointSavingExecutionABC"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingExecutionABC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_execution.CheckpointSavingExecutionABC.run_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingExecutionABC.run_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_instruction">modalities.checkpointing.checkpoint_saving_instruction module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.checkpoints_to_delete"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction.checkpoints_to_delete</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.save_current"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction.save_current</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_strategies">modalities.checkpointing.checkpoint_saving_strategies module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.CheckpointSavingStrategyIF"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingStrategyIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.CheckpointSavingStrategyIF.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingStrategyIF.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveEveryKStepsCheckpointingStrategy"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveEveryKStepsCheckpointingStrategy.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategy.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveKMostRecentCheckpointsStrategy"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveKMostRecentCheckpointsStrategy.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategy.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.config.html">modalities.config package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#modalities-config-component-factory-module">modalities.config.component_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#modalities-config-config-module">modalities.config.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#modalities-config-instantiation-models-module">modalities.config.instantiation_models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.lookup_enum">modalities.config.lookup_enum module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.lookup_enum.LookupEnum"><code class="docutils literal notranslate"><span class="pre">LookupEnum</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#modalities-config-pydantic-if-types-module">modalities.config.pydantic_if_types module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.utils">modalities.config.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.utils.convert_base_model_config_to_dict"><code class="docutils literal notranslate"><span class="pre">convert_base_model_config_to_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.utils.parse_torch_device"><code class="docutils literal notranslate"><span class="pre">parse_torch_device()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.conversion.html">modalities.conversion package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.conversion.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.conversion.gpt2.html">modalities.conversion.gpt2 package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.configuration_gpt2">modalities.conversion.gpt2.configuration_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.conversion_code">modalities.conversion.gpt2.conversion_code module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#modalities-conversion-gpt2-conversion-model-module">modalities.conversion.gpt2.conversion_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.conversion_tokenizer">modalities.conversion.gpt2.conversion_tokenizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#modalities-conversion-gpt2-convert-gpt2-module">modalities.conversion.gpt2.convert_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.modeling_gpt2">modalities.conversion.gpt2.modeling_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.conversion.html#module-modalities.conversion">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.dataloader.html">modalities.dataloader package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.preprocessing.html">modalities.dataloader.preprocessing package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.preprocessing.html#module-modalities.dataloader.preprocessing">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#modalities-dataloader-apply-chat-template-module">modalities.dataloader.apply_chat_template module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.create_index">modalities.dataloader.create_index module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_index.IndexGenerator"><code class="docutils literal notranslate"><span class="pre">IndexGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_index.IndexGenerator.create_index"><code class="docutils literal notranslate"><span class="pre">IndexGenerator.create_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#modalities-dataloader-create-instruction-tuning-data-module">modalities.dataloader.create_instruction_tuning_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.create_packed_data">modalities.dataloader.create_packed_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.DATA_SECTION_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.DATA_SECTION_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.HEADER_SIZE_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.HEADER_SIZE_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.data"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.index_base"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.index_base</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmptySampleError"><code class="docutils literal notranslate"><span class="pre">EmptySampleError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.PackedDataGenerator"><code class="docutils literal notranslate"><span class="pre">PackedDataGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.PackedDataGenerator.run"><code class="docutils literal notranslate"><span class="pre">PackedDataGenerator.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.join_embedded_stream_data"><code class="docutils literal notranslate"><span class="pre">join_embedded_stream_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.update_data_length_in_pre_allocated_header"><code class="docutils literal notranslate"><span class="pre">update_data_length_in_pre_allocated_header()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataloader">modalities.dataloader.dataloader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader"><code class="docutils literal notranslate"><span class="pre">LLMDataLoader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader.dataloader_tag"><code class="docutils literal notranslate"><span class="pre">LLMDataLoader.dataloader_tag</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataloader_factory">modalities.dataloader.dataloader_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader_factory.DataloaderFactory"><code class="docutils literal notranslate"><span class="pre">DataloaderFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader_factory.DataloaderFactory.get_dataloader"><code class="docutils literal notranslate"><span class="pre">DataloaderFactory.get_dataloader()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataset">modalities.dataloader.dataset module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.CombinedDataset"><code class="docutils literal notranslate"><span class="pre">CombinedDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDataset"><code class="docutils literal notranslate"><span class="pre">DummyDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.num_samples"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.sample_definition"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.sample_definition</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_shape"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_type"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType.FLOAT"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType.FLOAT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType.INT"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType.INT</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.MemMapDataset"><code class="docutils literal notranslate"><span class="pre">MemMapDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.DATA_SECTION_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.DATA_SECTION_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.HEADER_SIZE_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.HEADER_SIZE_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.np_dtype_of_tokens_on_disk_from_bytes"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.np_dtype_of_tokens_on_disk_from_bytes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.token_size_in_bytes"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.token_size_in_bytes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.type_converter_for_torch"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.type_converter_for_torch</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetContinuous"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetMegatron"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatron</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataset_factory">modalities.dataloader.dataset_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory"><code class="docutils literal notranslate"><span class="pre">DatasetFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_combined_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_combined_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_dummy_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_dummy_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_mem_map_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_mem_map_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_packed_mem_map_dataset_continuous"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_packed_mem_map_dataset_continuous()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_packed_mem_map_dataset_megatron"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_packed_mem_map_dataset_megatron()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_raw_index"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_raw_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.filter_packed_data">modalities.dataloader.filter_packed_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.filter_packed_data.filter_dataset"><code class="docutils literal notranslate"><span class="pre">filter_dataset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.large_file_lines_reader">modalities.dataloader.large_file_lines_reader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.BaseReader"><code class="docutils literal notranslate"><span class="pre">BaseReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader.close"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader.default_index_path"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader.default_index_path()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#modalities-dataloader-sampler-factory-module">modalities.dataloader.sampler_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.samplers">modalities.dataloader.samplers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.samplers.ResumableDistributedSampler"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.inference.html">modalities.inference package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.inference.text.html">modalities.inference.text package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#modalities-inference-text-config-module">modalities.inference.text.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#module-modalities.inference.text.inference_component">modalities.inference.text.inference_component module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#module-modalities.inference.text">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#modalities-inference-inference-module">modalities.inference.inference module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#module-modalities.inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.logging_broker.html">modalities.logging_broker package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html">modalities.logging_broker.subscriber_impl package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl.progress_subscriber">modalities.logging_broker.subscriber_impl.progress_subscriber module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#modalities-logging-broker-subscriber-impl-results-subscriber-module">modalities.logging_broker.subscriber_impl.results_subscriber module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#modalities-logging-broker-subscriber-impl-subscriber-factory-module">modalities.logging_broker.subscriber_impl.subscriber_factory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.message_broker">modalities.logging_broker.message_broker module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker"><code class="docutils literal notranslate"><span class="pre">MessageBroker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker.add_subscriber"><code class="docutils literal notranslate"><span class="pre">MessageBroker.add_subscriber()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker.distribute_message"><code class="docutils literal notranslate"><span class="pre">MessageBroker.distribute_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF.add_subscriber"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF.add_subscriber()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF.distribute_message"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF.distribute_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.messages">modalities.logging_broker.messages module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus.EVALUATION"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus.EVALUATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus.TRAIN"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus.TRAIN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message"><code class="docutils literal notranslate"><span class="pre">Message</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.global_rank"><code class="docutils literal notranslate"><span class="pre">Message.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.local_rank"><code class="docutils literal notranslate"><span class="pre">Message.local_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.message_type"><code class="docutils literal notranslate"><span class="pre">Message.message_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.payload"><code class="docutils literal notranslate"><span class="pre">Message.payload</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes"><code class="docutils literal notranslate"><span class="pre">MessageTypes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.BATCH_PROGRESS_UPDATE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.BATCH_PROGRESS_UPDATE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.ERROR_MESSAGE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.ERROR_MESSAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.EVALUATION_RESULT"><code class="docutils literal notranslate"><span class="pre">MessageTypes.EVALUATION_RESULT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.HIGH_LEVEL_PROGRESS_UPDATE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.HIGH_LEVEL_PROGRESS_UPDATE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.dataloader_tag"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.dataloader_tag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.experiment_status"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.experiment_status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.num_steps_done"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.num_steps_done</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.publisher">modalities.logging_broker.publisher module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher"><code class="docutils literal notranslate"><span class="pre">MessagePublisher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher.publish_message"><code class="docutils literal notranslate"><span class="pre">MessagePublisher.publish_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisherIF"><code class="docutils literal notranslate"><span class="pre">MessagePublisherIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisherIF.publish_message"><code class="docutils literal notranslate"><span class="pre">MessagePublisherIF.publish_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.subscriber">modalities.logging_broker.subscriber module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF.consume_dict"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF.consume_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF.consume_message"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF.consume_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.models.html">modalities.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.coca.html">modalities.models.coca package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.attention_pooling">modalities.models.coca.attention_pooling module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.coca_model">modalities.models.coca.coca_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.collator">modalities.models.coca.collator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.multi_modal_decoder">modalities.models.coca.multi_modal_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.text_decoder">modalities.models.coca.text_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.components.html">modalities.models.components package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#module-modalities.models.components.layer_norms">modalities.models.components.layer_norms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#module-modalities.models.components">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.gpt2.html">modalities.models.gpt2 package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2.collator">modalities.models.gpt2.collator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2.gpt2_model">modalities.models.gpt2.gpt2_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.huggingface.html">modalities.models.huggingface package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#module-modalities.models.huggingface.huggingface_model">modalities.models.huggingface.huggingface_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#module-modalities.models.huggingface">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.huggingface_adapters.html">modalities.models.huggingface_adapters package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#modalities-models-huggingface-adapters-hf-adapter-module">modalities.models.huggingface_adapters.hf_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#module-modalities.models.huggingface_adapters">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.parallelism.html">modalities.models.parallelism package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#modalities-models-parallelism-pipeline-parallelism-module">modalities.models.parallelism.pipeline_parallelism module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#modalities-models-parallelism-pipeline-parallelism-configs-module">modalities.models.parallelism.pipeline_parallelism_configs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#module-modalities.models.parallelism.stages_generator">modalities.models.parallelism.stages_generator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#module-modalities.models.parallelism.stages_generator_configs">modalities.models.parallelism.stages_generator_configs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.parallelism.html#module-modalities.models.parallelism">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.vision_transformer.html">modalities.models.vision_transformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#module-modalities.models.vision_transformer.vision_transformer_model">modalities.models.vision_transformer.vision_transformer_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#module-modalities.models.vision_transformer">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models.model">modalities.models.model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType"><code class="docutils literal notranslate"><span class="pre">ActivationType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType.GELU"><code class="docutils literal notranslate"><span class="pre">ActivationType.GELU</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType.SWIGLU"><code class="docutils literal notranslate"><span class="pre">ActivationType.SWIGLU</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel"><code class="docutils literal notranslate"><span class="pre">NNModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.forward"><code class="docutils literal notranslate"><span class="pre">NNModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.get_parameters"><code class="docutils literal notranslate"><span class="pre">NNModel.get_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.weight_decay_groups"><code class="docutils literal notranslate"><span class="pre">NNModel.weight_decay_groups</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.SwiGLU"><code class="docutils literal notranslate"><span class="pre">SwiGLU</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.SwiGLU.forward"><code class="docutils literal notranslate"><span class="pre">SwiGLU.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.model_predict_batch"><code class="docutils literal notranslate"><span class="pre">model_predict_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#modalities-models-model-factory-module">modalities.models.model_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#modalities-models-utils-module">modalities.models.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.nn.html">modalities.nn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.model_initialization.html">modalities.nn.model_initialization package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#modalities-nn-model-initialization-composed-initialization-module">modalities.nn.model_initialization.composed_initialization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.initialization_if">modalities.nn.model_initialization.initialization_if module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.initialization_routines">modalities.nn.model_initialization.initialization_routines module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.parameter_name_filters">modalities.nn.model_initialization.parameter_name_filters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn.attention">modalities.nn.attention module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig"><code class="docutils literal notranslate"><span class="pre">AttentionConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig.attention_engine_type"><code class="docutils literal notranslate"><span class="pre">AttentionConfig.attention_engine_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig.model_config"><code class="docutils literal notranslate"><span class="pre">AttentionConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType.DEFAULT_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType.DEFAULT_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType.PYTORCH_FLASH_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType.PYTORCH_FLASH_ATTENTION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType"><code class="docutils literal notranslate"><span class="pre">AttentionType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.CAUSAL_SELF_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.CAUSAL_SELF_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.CROSS_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.CROSS_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.NON_CAUSAL_SELF_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.NON_CAUSAL_SELF_ATTENTION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.MultiHeadAttention"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.MultiHeadAttention.forward"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn.mlp">modalities.nn.mlp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.mlp.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.mlp.MLP.forward"><code class="docutils literal notranslate"><span class="pre">MLP.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.optimizers.html">modalities.optimizers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.lr_schedulers">modalities.optimizers.lr_schedulers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.lr_schedulers.DummyLRScheduler"><code class="docutils literal notranslate"><span class="pre">DummyLRScheduler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.lr_schedulers.DummyLRScheduler.get_lr"><code class="docutils literal notranslate"><span class="pre">DummyLRScheduler.get_lr()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.optimizer_factory">modalities.optimizers.optimizer_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_adam"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_adam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_adam_w"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_adam_w()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_fsdp1_checkpointed_optimizer_"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_fsdp1_checkpointed_optimizer_()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.get_optimizer_groups"><code class="docutils literal notranslate"><span class="pre">get_optimizer_groups()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.optimizer_list">modalities.optimizers.optimizer_list module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_list.OptimizersList"><code class="docutils literal notranslate"><span class="pre">OptimizersList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_list.OptimizersList.load_state_dict"><code class="docutils literal notranslate"><span class="pre">OptimizersList.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_list.OptimizersList.state_dict"><code class="docutils literal notranslate"><span class="pre">OptimizersList.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_list.OptimizersList.step"><code class="docutils literal notranslate"><span class="pre">OptimizersList.step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_list.OptimizersList.zero_grad"><code class="docutils literal notranslate"><span class="pre">OptimizersList.zero_grad()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.scheduler_list">modalities.optimizers.scheduler_list module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList"><code class="docutils literal notranslate"><span class="pre">SchedulerList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.base_lrs"><code class="docutils literal notranslate"><span class="pre">SchedulerList.base_lrs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.get_last_lr"><code class="docutils literal notranslate"><span class="pre">SchedulerList.get_last_lr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.get_lr"><code class="docutils literal notranslate"><span class="pre">SchedulerList.get_lr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.last_epoch"><code class="docutils literal notranslate"><span class="pre">SchedulerList.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.load_state_dict"><code class="docutils literal notranslate"><span class="pre">SchedulerList.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.state_dict"><code class="docutils literal notranslate"><span class="pre">SchedulerList.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.scheduler_list.SchedulerList.step"><code class="docutils literal notranslate"><span class="pre">SchedulerList.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.preprocessing.html">modalities.preprocessing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing.create_chunks">modalities.preprocessing.create_chunks module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking"><code class="docutils literal notranslate"><span class="pre">Chunking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.get_jsonl_file_chunk"><code class="docutils literal notranslate"><span class="pre">Chunking.get_jsonl_file_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.get_tokenized_file_chunk"><code class="docutils literal notranslate"><span class="pre">Chunking.get_tokenized_file_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.shuffle_file_chunks_in_place"><code class="docutils literal notranslate"><span class="pre">Chunking.shuffle_file_chunks_in_place()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing.shuffle_data">modalities.preprocessing.shuffle_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler"><code class="docutils literal notranslate"><span class="pre">DataShuffler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler.shuffle_jsonl_data"><code class="docutils literal notranslate"><span class="pre">DataShuffler.shuffle_jsonl_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler.shuffle_tokenized_data"><code class="docutils literal notranslate"><span class="pre">DataShuffler.shuffle_tokenized_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.registry.html">modalities.registry package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#modalities-registry-components-module">modalities.registry.components module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#modalities-registry-registry-module">modalities.registry.registry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#module-modalities.registry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.running_env.html">modalities.running_env package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.fsdp.html">modalities.running_env.fsdp package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp.device_mesh">modalities.running_env.fsdp.device_mesh module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp.fsdp_auto_wrapper">modalities.running_env.fsdp.fsdp_auto_wrapper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp.reducer">modalities.running_env.fsdp.reducer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#modalities-running-env-cuda-env-module">modalities.running_env.cuda_env module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#module-modalities.running_env.env_utils">modalities.running_env.env_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.FSDP2MixedPrecisionSettings"><code class="docutils literal notranslate"><span class="pre">FSDP2MixedPrecisionSettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.FSDP2MixedPrecisionSettings.model_config"><code class="docutils literal notranslate"><span class="pre">FSDP2MixedPrecisionSettings.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.FSDP2MixedPrecisionSettings.param_dtype"><code class="docutils literal notranslate"><span class="pre">FSDP2MixedPrecisionSettings.param_dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.FSDP2MixedPrecisionSettings.reduce_dtype"><code class="docutils literal notranslate"><span class="pre">FSDP2MixedPrecisionSettings.reduce_dtype</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.BF_16"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.BF_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.BF_16_WORKING"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.BF_16_WORKING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.FP_16"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.FP_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.FP_32"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.FP_32</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.MIXED_PRECISION_MEGATRON"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.MIXED_PRECISION_MEGATRON</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.NO_MIXED_PRECISION"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.NO_MIXED_PRECISION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.PyTorchDtypes"><code class="docutils literal notranslate"><span class="pre">PyTorchDtypes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.PyTorchDtypes.BF_16"><code class="docutils literal notranslate"><span class="pre">PyTorchDtypes.BF_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.PyTorchDtypes.FP_16"><code class="docutils literal notranslate"><span class="pre">PyTorchDtypes.FP_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.PyTorchDtypes.FP_32"><code class="docutils literal notranslate"><span class="pre">PyTorchDtypes.FP_32</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.has_bfloat_support"><code class="docutils literal notranslate"><span class="pre">has_bfloat_support()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.is_running_with_torchrun"><code class="docutils literal notranslate"><span class="pre">is_running_with_torchrun()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#module-modalities.running_env">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.tokenization.html">modalities.tokenization package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#module-modalities.tokenization.tokenizer_wrapper">modalities.tokenization.tokenizer_wrapper module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.decode"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.get_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.special_tokens"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.special_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.tokenize"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.vocab_size"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.decode"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.get_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.tokenize"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.vocab_size"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.decode"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.get_token_id"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.tokenize"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.vocab_size"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.vocab_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#module-modalities.tokenization">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.training.html">modalities.training package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.activation_checkpointing.html">modalities.training.activation_checkpointing package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.activation_checkpointing.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.activation_checkpointing.html#modalities-training-activation-checkpointing-activation-checkpointing-module">modalities.training.activation_checkpointing.activation_checkpointing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.activation_checkpointing.html#module-modalities.training.activation_checkpointing.activation_checkpointing_variants">modalities.training.activation_checkpointing.activation_checkpointing_variants module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.activation_checkpointing.html#module-modalities.training.activation_checkpointing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.gradient_clipping.html">modalities.training.gradient_clipping package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping.fsdp_gradient_clipper">modalities.training.gradient_clipping.fsdp_gradient_clipper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#modalities-training-gradient-clipping-fsdp-gradient-clipper-config-module">modalities.training.gradient_clipping.fsdp_gradient_clipper_config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping.gradient_clipper">modalities.training.gradient_clipping.gradient_clipper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#module-modalities.training.training_progress">modalities.training.training_progress module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress"><code class="docutils literal notranslate"><span class="pre">TrainingProgress</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_current_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_current_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_previous_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_previous_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_total"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_current_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_current_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_previous_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_previous_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_total"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_target_steps"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_target_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_target_tokens"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_target_tokens</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#module-modalities.training">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.utils.html">modalities.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.benchmarking.html">modalities.utils.benchmarking package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.benchmarking.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.benchmarking.html#module-modalities.utils.benchmarking.benchmarking_utils">modalities.utils.benchmarking.benchmarking_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.benchmarking.html#module-modalities.utils.benchmarking.sweep_utils">modalities.utils.benchmarking.sweep_utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.benchmarking.html#module-modalities.utils.benchmarking">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.profilers.html">modalities.utils.profilers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers.batch_generator">modalities.utils.profilers.batch_generator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities-utils-profilers-modalities-profiler-module">modalities.utils.profilers.modalities_profiler module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities-utils-profilers-profiler-configs-module">modalities.utils.profilers.profiler_configs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities-utils-profilers-profiler-factory-module">modalities.utils.profilers.profiler_factory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers.profilers">modalities.utils.profilers.profilers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#modalities-utils-profilers-steppable-component-configs-module">modalities.utils.profilers.steppable_component_configs module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers.steppable_components">modalities.utils.profilers.steppable_components module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers.steppable_components_if">modalities.utils.profilers.steppable_components_if module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.profilers.html#module-modalities.utils.profilers">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.communication_test">modalities.utils.communication_test module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.communication_test.run_communication_test"><code class="docutils literal notranslate"><span class="pre">run_communication_test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.debug">modalities.utils.debug module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug.debug_nan_hook"><code class="docutils literal notranslate"><span class="pre">debug_nan_hook()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug.enable_deterministic_cuda"><code class="docutils literal notranslate"><span class="pre">enable_deterministic_cuda()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug.print_forward_hook"><code class="docutils literal notranslate"><span class="pre">print_forward_hook()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.debug_components">modalities.utils.debug_components module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug_components.Debugging"><code class="docutils literal notranslate"><span class="pre">Debugging</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug_components.HookRegistration"><code class="docutils literal notranslate"><span class="pre">HookRegistration</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug_components.HookRegistration.register_forward_hooks"><code class="docutils literal notranslate"><span class="pre">HookRegistration.register_forward_hooks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug_components.HookRegistration.register_nan_hooks"><code class="docutils literal notranslate"><span class="pre">HookRegistration.register_nan_hooks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.debug_components.HookRegistration.register_print_forward_hooks"><code class="docutils literal notranslate"><span class="pre">HookRegistration.register_print_forward_hooks()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#modalities-utils-debugging-configs-module">modalities.utils.debugging_configs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.deprecated_alias">modalities.utils.deprecated_alias module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.deprecated_alias.add_deprecated_alias"><code class="docutils literal notranslate"><span class="pre">add_deprecated_alias()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.file_ops">modalities.utils.file_ops module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.file_ops.get_file_md5sum"><code class="docutils literal notranslate"><span class="pre">get_file_md5sum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.logger_utils">modalities.utils.logger_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.logger_utils.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.maybe_list_parameter">modalities.utils.maybe_list_parameter module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.maybe_list_parameter.maybe_list_parameter"><code class="docutils literal notranslate"><span class="pre">maybe_list_parameter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.mfu">modalities.utils.mfu module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.GPT2MFUCalculator"><code class="docutils literal notranslate"><span class="pre">GPT2MFUCalculator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.GPT2MFUCalculator.compute"><code class="docutils literal notranslate"><span class="pre">GPT2MFUCalculator.compute()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.MFUCalculatorABC"><code class="docutils literal notranslate"><span class="pre">MFUCalculatorABC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.MFUCalculatorABC.compute"><code class="docutils literal notranslate"><span class="pre">MFUCalculatorABC.compute()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.number_conversion">modalities.utils.number_conversion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.global_num_samples"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.global_num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.num_ranks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.global_num_tokens"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.global_num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.num_tokens"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.global_num_samples"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.global_num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.num_ranks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.dp_degree"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.dp_degree</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.global_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.global_num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.raw_index_path"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.raw_index_path</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.dp_degree"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.dp_degree</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.num_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.dp_degree"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.dp_degree</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.reuse_last_target"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.reuse_last_target</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion"><code class="docutils literal notranslate"><span class="pre">NumberConversion</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_global_num_seen_tokens_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_global_num_seen_tokens_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_global_num_target_tokens_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_global_num_target_tokens_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_last_step_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_last_step_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_samples"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_local_num_batches_from_num_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_local_num_batches_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_samples_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_samples_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_seen_steps_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_seen_steps_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_samples"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_num_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_raw_dataset_index"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_raw_dataset_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_target_steps_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_target_steps_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_num_steps"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_tokens_from_num_steps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig.checkpoint_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig.model_config</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.seeding">modalities.utils.seeding module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.seeding.calculate_hashed_seed"><code class="docutils literal notranslate"><span class="pre">calculate_hashed_seed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.typing_utils">modalities.utils.typing_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#modalities-utils-verify-tokenization-consistency-module">modalities.utils.verify_tokenization_consistency module</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="modalities-api-module">
<h2>modalities.api module<a class="headerlink" href="#modalities-api-module" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.batch">
<span id="modalities-batch-module"></span><h2>modalities.batch module<a class="headerlink" href="#module-modalities.batch" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.Batch">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">Batch</span></span><a class="reference internal" href="../_modules/modalities/batch.html#Batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.Batch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract class that defines the necessary methods any <cite>Batch</cite> implementation needs to implement.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">DatasetBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a>, <a class="reference internal" href="#modalities.batch.TorchDeviceMixin" title="modalities.batch.TorchDeviceMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></p>
<p>A batch of samples and its targets. Used to batch train a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>batch_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.batch_dim">
<span class="sig-name descname"><span class="pre">batch_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#modalities.batch.DatasetBatch.batch_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.device">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">device</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span><a class="headerlink" href="#modalities.batch.DatasetBatch.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.DatasetBatch.samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.DatasetBatch.targets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">EvaluationResultBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_train_steps_done</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throughput_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#EvaluationResultBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.EvaluationResultBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a></p>
<p>Data class for storing the results of a single or multiple batches.
Also entire epoch results are stored in here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader_tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>num_train_steps_done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
<li><p><strong>losses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
<li><p><strong>throughput_metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.dataloader_tag">
<span class="sig-name descname"><span class="pre">dataloader_tag</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.dataloader_tag" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><span class="pre">ResultItem</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.losses" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><span class="pre">ResultItem</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.num_train_steps_done">
<span class="sig-name descname"><span class="pre">num_train_steps_done</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.num_train_steps_done" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.throughput_metrics">
<span class="sig-name descname"><span class="pre">throughput_metrics</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><span class="pre">ResultItem</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.throughput_metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">InferenceResultBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a>, <a class="reference internal" href="#modalities.batch.TorchDeviceMixin" title="modalities.batch.TorchDeviceMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></p>
<p>Stores targets and predictions of an entire batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>predictions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>batch_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.batch_dim">
<span class="sig-name descname"><span class="pre">batch_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#modalities.batch.InferenceResultBatch.batch_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.device">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">device</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span><a class="headerlink" href="#modalities.batch.InferenceResultBatch.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.get_predictions" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.get_targets">
<span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.get_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.get_targets" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.predictions">
<span class="sig-name descname"><span class="pre">predictions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.InferenceResultBatch.predictions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.InferenceResultBatch.targets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.to_cpu">
<span class="sig-name descname"><span class="pre">to_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.to_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.to_cpu" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.ResultItem">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">ResultItem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimal_places</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#ResultItem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.ResultItem" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a>)</p></li>
<li><p><strong>decimal_places</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.ResultItem.decimal_places">
<span class="sig-name descname"><span class="pre">decimal_places</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#modalities.batch.ResultItem.decimal_places" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.ResultItem.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;</span></span><a class="headerlink" href="#modalities.batch.ResultItem.value" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">TorchDeviceMixin</span></span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.detach">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.device">
<span class="property"><span class="k"><span class="pre">abstract</span></span><span class="w"> </span><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">device</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><span class="pre">device</span></a></span><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.to">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="modalities-evaluator-module">
<h2>modalities.evaluator module<a class="headerlink" href="#modalities-evaluator-module" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.exceptions">
<span id="modalities-exceptions-module"></span><h2>modalities.exceptions module<a class="headerlink" href="#module-modalities.exceptions" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.BatchStateError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">BatchStateError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#BatchStateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.BatchStateError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.CheckpointingError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">CheckpointingError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#CheckpointingError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.CheckpointingError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.ConfigError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">ConfigError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#ConfigError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.ConfigError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.DatasetNotFoundError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">DatasetNotFoundError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#DatasetNotFoundError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.DatasetNotFoundError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.ModelStateError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">ModelStateError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#ModelStateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.ModelStateError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.OptimizerError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">OptimizerError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#OptimizerError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.OptimizerError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.RunningEnvError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">RunningEnvError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#RunningEnvError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.RunningEnvError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.TimeRecorderStateError">
<span class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">TimeRecorderStateError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#TimeRecorderStateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.TimeRecorderStateError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

</section>
<section id="modalities-gym-module">
<h2>modalities.gym module<a class="headerlink" href="#modalities-gym-module" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.loss_functions">
<span id="modalities-loss-functions-module"></span><h2>modalities.loss_functions module<a class="headerlink" href="#module-modalities.loss_functions" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.CLMCrossEntropyLoss">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">CLMCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CLMCrossEntropyLoss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#CLMCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.CLMCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>prediction_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.Loss">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.Loss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="modalities.loss_functions.Loss.tag">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">tag</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#modalities.loss_functions.Loss.tag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.NCELoss">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">NCELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_key1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_asymmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NCELoss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#NCELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.NCELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a></p>
<p>Noise Contrastive Estimation Loss</p>
<dl class="simple">
<dt>Args:</dt><dd><p>prediction_key1 (str): key to access embedding 1.
prediction_key2 (str): key to access embedding 2.
is_asymmetric (bool, optional): specifies symmetric or asymmetric calculation of NCEloss. Defaults to True.
temperature (float, optional): temperature. Defaults to 1.0.
tag (str, optional): Defaults to “NCELoss”.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_key1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>prediction_key2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>is_asymmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p></li>
<li><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.loss_functions.nce_loss">
<span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">nce_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_asymmetric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#nce_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.nce_loss" title="Link to this definition"></a></dt>
<dd><p>This implementation calculates the noise contrastive estimation loss between embeddings of two different modalities
Implementation slightly adapted from <a class="reference external" href="https://arxiv.org/pdf/1912.06430.pdf">https://arxiv.org/pdf/1912.06430.pdf</a>, <a class="reference external" href="https://github.com/antoine77340/MIL-NCE_HowTo100M">https://github.com/antoine77340/MIL-NCE_HowTo100M</a>
changes include adding a temperature value and the choice of calculating asymmetric loss w.r.t. one modality
This implementation is adapted to contrastive loss from CoCa model <a class="reference external" href="https://arxiv.org/pdf/2205.01917.pdf">https://arxiv.org/pdf/2205.01917.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>embedding1</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a>)</p></li>
<li><p><strong>embedding2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a>)</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>device</em></a>)</p></li>
<li><p><strong>is_asymmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>embedding1 (torch.Tensor): embeddings from modality 1 of size batch_size x embed_dim.
embedding2 (torch.Tensor): embeddings from modality 2 of size batch_size x embed_dim.
device (torch.device): torch device for calculating loss.
is_asymmetric (bool): boolean value to specify if the loss is calculated in one direction or both directions.
temperature (float): temperature value for regulating loss.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: loss tensor.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="modalities-main-module">
<h2>modalities.main module<a class="headerlink" href="#modalities-main-module" title="Link to this heading"></a></h2>
</section>
<section id="modalities-trainer-module">
<h2>modalities.trainer module<a class="headerlink" href="#modalities-trainer-module" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.util">
<span id="modalities-util-module"></span><h2>modalities.util module<a class="headerlink" href="#module-modalities.util" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">TimeRecorder</span></span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class with context manager to record execution time</p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.start" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.stop" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">TimeRecorderStates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorderStates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorderStates" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates.RUNNING">
<span class="sig-name descname"><span class="pre">RUNNING</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'RUNNING'</span></span><a class="headerlink" href="#modalities.util.TimeRecorderStates.RUNNING" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates.STOPPED">
<span class="sig-name descname"><span class="pre">STOPPED</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'STOPPED'</span></span><a class="headerlink" href="#modalities.util.TimeRecorderStates.STOPPED" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.cpu_scalar_float">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">cpu_scalar_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#cpu_scalar_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.cpu_scalar_float" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.cpu_scalar_int">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">cpu_scalar_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#cpu_scalar_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.cpu_scalar_int" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>Tensor</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.format_metrics_to_gb">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">format_metrics_to_gb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#format_metrics_to_gb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.format_metrics_to_gb" title="Link to this definition"></a></dt>
<dd><p>quick function to format numbers to gigabyte and round to 4 digit precision</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>item</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_experiment_id_from_config">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_experiment_id_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_experiment_id_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_experiment_id_from_config" title="Link to this definition"></a></dt>
<dd><p>Create experiment ID including the date and time for file save uniqueness
example: 2022-05-07__14-31-22_fdh1xaj2’</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><em>Path</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>hash_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_local_number_of_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_local_number_of_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_local_number_of_trainable_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_local_number_of_trainable_parameters" title="Link to this definition"></a></dt>
<dd><p>Returns the number of trainable parameters that are materialized on the current rank.
The model can be sharded with FSDP1 or FSDP2 or not sharded at all.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><em>Module</em></a>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nn.Module): The model for which to calculate the number of trainable parameters.</p>
</dd>
<dt>Returns:</dt><dd><p>int: The number of trainable parameters materialized on the current rank.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_module_class_from_name">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_module_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_module_class_from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_module_class_from_name" title="Link to this definition"></a></dt>
<dd><p>From Accelerate source code
(<a class="reference external" href="https://github.com/huggingface/accelerate/blob/1f7a79b428749f45187ec69485f2c966fe21926e/src/accelerate/utils/dataclasses.py#L1902">https://github.com/huggingface/accelerate/blob/1f7a79b428749f45187ec69485f2c966fe21926e/src/accelerate/utils/dataclasses.py#L1902</a>)
Gets a class from a module by its name.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>]]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>module</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><em>Module</em></a>)</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>module (<cite>torch.nn.Module</cite>): The module to get the class from.
name (<cite>str</cite>): The name of the class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_synced_experiment_id_of_run">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_synced_experiment_id_of_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_experiment_id_byte_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_synced_experiment_id_of_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_synced_experiment_id_of_run" title="Link to this definition"></a></dt>
<dd><p>Create a unique experiment ID for the current run on rank 0 and broadcast it to all ranks.
Internally, the experiment ID is generated by hashing the configuration file path and appending
the current date and time.
The experiment ID is then converted to a byte array (with maximum length of max_experiment_id_byte_length) and
broadcasted to all ranks. In the unlikely case of the experiment ID being too long, a ValueError is raised
and max_experiment_id_byte_length must be increased. Each rank then decodes the byte array to the original
string representation and returns it. Having a globally synced experiment ID is mandatory for
saving files / checkpionts in a distributed training setup.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><em>Path</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>hash_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_experiment_id_byte_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Args:</dt><dd><p>config_file_path (Path): Path to the configuration file.
hash_length (Optional[int], optional): Defines the char length of the commit hash. Defaults to 16.
max_experiment_id_byte_length (Optional[int]): Defines max byte length of the experiment_id</p>
<blockquote>
<div><p>to be shared to other ranks. Defaults to 1024.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>str: The experiment ID.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_synced_string">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_synced_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string_to_be_synced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_string_byte_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_synced_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_synced_string" title="Link to this definition"></a></dt>
<dd><p>Broadcast a string from one rank to all other ranks in the distributed setup.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>string_to_be_synced</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>from_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
<li><p><strong>max_string_byte_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Args:</dt><dd><p>string_to_be_synced (str): The string to be synced across ranks.
from_rank (int, optional): The rank that generates the string. Defaults to 0.
max_string_byte_length (Optional[int], optional): Maximum byte length of the string to be synced.</p>
<blockquote>
<div><p>Defaults to 1024.</p>
</div></blockquote>
</dd>
<dt>Returns:</dt><dd><p>str: The synced string, decoded from the byte array.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the string exceeds the maximum byte length.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_total_number_of_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_total_number_of_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device_mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_total_number_of_trainable_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_total_number_of_trainable_parameters" title="Link to this definition"></a></dt>
<dd><p>Returns the total number of trainable parameters across all ranks.
The model must be sharded with FSDP1 or FSDP2.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/fsdp.html#torch.distributed.fsdp.FullyShardedDataParallel" title="(in PyTorch v2.10)"><em>FullyShardedDataParallel</em></a><em> | </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/distributed.fsdp.fully_shard.html#torch.distributed.fsdp.FSDPModule" title="(in PyTorch v2.10)"><em>FSDPModule</em></a>)</p></li>
<li><p><strong>device_mesh</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/distributed.html#torch.distributed.device_mesh.DeviceMesh" title="(in PyTorch v2.10)"><em>DeviceMesh</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>model (FSDPX): The model for which to calculate the number of trainable parameters.
device_mesh (DeviceMesh | None): The device mesh used for distributed training.</p>
</dd>
<dt>Returns:</dt><dd><p>Number: The total number of trainable parameters across all ranks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.parse_enum_by_name">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">parse_enum_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enum_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#parse_enum_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.parse_enum_by_name" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.TypeVar" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code></a>(<code class="docutils literal notranslate"><span class="pre">TEnum</span></code>, bound= <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a>)</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p></li>
<li><p><strong>enum_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.14)"><em>Type</em></a><em>[</em><em>TEnum</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.print_rank_0">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">print_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#print_rank_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.print_rank_0" title="Link to this definition"></a></dt>
<dd><p>If torch.distributed is initialized, print only on rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.warn_rank_0">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">warn_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#warn_rank_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.warn_rank_0" title="Link to this definition"></a></dt>
<dd><p>If torch.distributed is initialized, print only on rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-modalities" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="modalities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modalities.checkpointing.html" class="btn btn-neutral float-right" title="modalities.checkpointing package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>